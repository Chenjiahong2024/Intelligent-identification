# 真机运行配置指南

## 问题 1: Program License Agreement (PLA) 更新

### 错误信息
```
Unable to process request - PLA Update available: You currently don't have access to this membership resource. 
To resolve this issue, agree to the latest Program License Agreement in your developer account.
```

### 解决步骤

1. **访问 Apple Developer 网站**
   - 打开浏览器访问：https://developer.apple.com/account
   - 使用您的 Apple ID 登录

2. **同意最新协议**
   - 登录后，如果有待处理的协议，会在顶部看到红色或黄色的提示横幅
   - 点击"Review Agreement"（查看协议）
   - 仔细阅读后，滚动到底部
   - 勾选"I have read and agree..."（我已阅读并同意...）
   - 点击"Submit"（提交）

3. **等待更新生效**
   - 协议提交后，可能需要等待几分钟
   - 刷新页面确认协议状态变为"Active"

4. **返回 Xcode**
   - 关闭 Xcode
   - 重新打开项目
   - 前往 `Xcode > Settings > Accounts`
   - 选择您的 Apple ID，点击右下角的刷新图标 ⟳

---

## 问题 2: Provisioning Profile 不包含当前设备

### 错误信息
```
Provisioning profile "iOS Team Provisioning Profile: *" doesn't include the currently selected device 
"Jiahong Chen's iPhone" (identifier 00008140-0006755A1E68801C).
```

### 解决方案 A: 自动管理签名（推荐）

1. **在 Xcode 中配置**
   - 选择项目导航器中的项目文件（蓝色图标）
   - 选择 "Intelligent identification" target
   - 点击 "Signing & Capabilities" 标签

2. **启用自动签名**
   - 确保勾选 ✅ **"Automatically manage signing"**
   - 在 "Team" 下拉菜单中选择您的 Apple ID 团队
   - Xcode 会自动为您的设备创建和更新 provisioning profile

3. **注册设备**
   - 连接您的 iPhone
   - 在 Xcode 顶部选择 "Jiahong Chen's iPhone" 作为运行目标
   - Xcode 会自动将设备添加到开发者账户

4. **清理并重新构建**
   - `Product > Clean Build Folder` (⇧⌘K)
   - `Product > Build` (⌘B)

### 解决方案 B: 手动注册设备

如果自动签名失败，手动注册设备：

1. **获取设备 UDID**
   - 连接 iPhone 到 Mac
   - 打开 Xcode > Window > Devices and Simulators
   - 选择您的设备
   - 找到 "Identifier" 字段（就是您看到的 `00008140-0006755A1E68801C`）
   - 右键点击复制

2. **在 Apple Developer 网站注册**
   - 访问：https://developer.apple.com/account/resources/devices/list
   - 点击 "+" 按钮添加新设备
   - 选择 "iOS/iPadOS"
   - 输入设备名称（例如：Jiahong Chen's iPhone）
   - 粘贴 UDID
   - 点击 "Continue" 并确认

3. **刷新 Provisioning Profiles**
   - 返回 Xcode
   - `Xcode > Settings > Accounts`
   - 选择您的 Apple ID
   - 点击 "Download Manual Profiles" 或刷新按钮

4. **重新构建**
   - `Product > Clean Build Folder` (⇧⌘K)
   - 重新运行项目

---

## 问题 3: 代码弃用警告（已修复）

### 错误信息
```
'contentEdgeInsets' was deprecated in iOS 15.0: This property is ignored when using UIButtonConfiguration
```

### 解决状态
✅ **已修复**

我已经将 `CameraView.swift` 中的 `closeButton` 更新为使用现代的 `UIButton.Configuration` API，不再使用已弃用的 `contentEdgeInsets`。

---

## 快速验证清单

完成上述步骤后，按以下顺序验证：

- [ ] Apple Developer 账户协议已同意
- [ ] Xcode 中已选择正确的 Team
- [ ] "Automatically manage signing" 已勾选
- [ ] 设备已在 Developer Portal 注册
- [ ] 清理构建文件夹 (⇧⌘K)
- [ ] 重新构建项目 (⌘B)
- [ ] 在真机上运行 (⌘R)

---

## 常见问题

### Q: 我没有付费的 Apple Developer Program 账号怎么办？

**A**: 使用免费的 Apple ID 也可以在真机上测试：
- 使用您的个人 Apple ID
- 应用只能在真机上运行 7 天后需要重新签名
- 每个免费账号同时只能运行 3 个应用
- 某些功能（如推送通知、iCloud）不可用
- **对于本应用，免费账号完全够用**

### Q: 构建成功但运行时提示"不受信任的开发者"

**A**: 在 iPhone 上信任开发者证书：
1. 打开 iPhone 的 `设置` app
2. 进入 `通用` > `VPN与设备管理`（或 `设备管理`）
3. 找到您的开发者账号
4. 点击 `信任 [您的开发者账号]`
5. 确认信任

### Q: Xcode 显示"无法连接到设备"

**A**: 
1. 拔掉 USB 线重新连接
2. 解锁 iPhone 并点击"信任此电脑"
3. 重启 Xcode 和 iPhone
4. 检查 USB 线是否支持数据传输（不是仅充电线）

---

## 成功标志

当一切配置正确后，您应该看到：

- ✅ Xcode 顶部状态栏没有红色或黄色警告
- ✅ "Signing & Capabilities" 中显示绿色的 Provisioning Profile
- ✅ 点击运行按钮后应用安装到 iPhone 并启动
- ✅ 主界面显示当前使用的 AI 模型（Vision Default / FastVLM / Apple Intelligence）

---

## 技术支持

如果按照上述步骤仍然无法解决，请检查：

1. **网络连接** - 需要连接互联网以同步证书
2. **Xcode 版本** - 建议使用最新稳定版
3. **iOS 版本** - 确保设备运行 iOS 15.0 或更高版本
4. **存储空间** - iPhone 上有足够空间安装应用

---

祝您顺利运行！🎉

